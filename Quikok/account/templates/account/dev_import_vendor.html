{% extends 'base_layout_no_elements.html' %}
{% load static %}

{% block content %}
<div class="container" style="font-family: Microsoft Yahei;">
    <div class="row mt-5">
        <div class="col">
            <div class="p-3 mb-2 bg-white text-dark">
                <h1 class="display-5"><b>匯入老師資料(開發中)</b></h1>
                <p style="font-size:22px; color: #626567;">
                    - 老師註冊資料的Google Form匯出成Excel檔案後，可以整批匯入到系統當中。<br>
                    - 帳號預設為註冊時的Email，密碼預設為"00000000"。</p>

                <form method="post" enctype="multipart/form-data" action="">
                    {% csrf_token %}
                    <div class="row mt-3">
                        <input class="col-7" id="files" type="file" multiple name="files"
                            accept=".xls,.xlsx,.csv,.xlsm,.xlsb" />
                        <div class="col-5">
                            <input id="upload_vendor_info" style="width:250px;height:70px;"
                                class="btn btn-primary btn-lg" type="submit" role="button" value=確定匯入 disabled=true>

                            <button class="btn btn-primary btn-lg" type="button" style="width:250px;height:70px;"
                                id="upload_vendor_info_running" disabled>
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                資料匯入中
                            </button>
                        </div>

                    </div>
                </form>
                </p>

                {% if is_imported %}
                <hr>
                <a style="font-size: 28px; color: blueviolet;"><b>資料匯入成功囉!</b></a>
                {% endif %}
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $("#upload_vendor_info_running").hide();

            $("#upload_vendor_info").click(function () {
                $(this).hide();
                $("#upload_vendor_info_running").show();
            });

            $("#files").change(function () {
                if (document.getElementById("files").files.length == 0) {
                    $('#upload_vendor_info').attr('disabled', true);
                } else {
                    $('#upload_vendor_info').removeAttr('disabled');
                }
            });
        });
    </script>
    {% endblock %}